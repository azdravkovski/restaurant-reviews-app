let fetchedCuisines,fetchedNeighborhoods;class DBHelper{static get DATABASE_URL(){return"http://localhost:1337/restaurants"}static get dbPromise(){return navigator.serviceWorker?idb.open("restaurants",1,function(t){t.createObjectStore("all-restaurants",{keyPath:"id"})}):Promise.resolve()}static fetchRestaurants(t){DBHelper.dbPromise.then(e=>{if(!e)return;e.transaction("all-restaurants").objectStore("all-restaurants").getAll().then(r=>{0===r.length?fetch(`${DBHelper.DATABASE_URL}`).then(t=>t.json()).then(r=>{const a=e.transaction("all-restaurants","readwrite").objectStore("all-restaurants");r.forEach(t=>{a.put(t)}),t(null,r)}).catch(e=>{t(e,null)}):t(null,r)})})}static fetchRestaurantById(t,e){DBHelper.fetchRestaurants((r,a)=>{if(r)e(r,null);else{const r=a.find(e=>e.id==t);r?e(null,r):e("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(t,e){DBHelper.fetchRestaurants((r,a)=>{if(r)e(r,null);else{const r=a.filter(e=>e.cuisine_type==t);e(null,r)}})}static fetchRestaurantByNeighborhood(t,e){DBHelper.fetchRestaurants((r,a)=>{if(r)e(r,null);else{const r=a.filter(e=>e.neighborhood==t);e(null,r)}})}static fetchRestaurantByCuisineAndNeighborhood(t,e,r){DBHelper.fetchRestaurants((a,l)=>{if(a)r(a,null);else{let a=l;"all"!=t&&(a=a.filter(e=>e.cuisine_type==t)),"all"!=e&&(a=a.filter(t=>t.neighborhood==e)),r(null,a)}})}static fetchNeighborhoods(t){DBHelper.fetchRestaurants((e,r)=>{if(e)t(e,null);else{const e=r.map((t,e)=>r[e].neighborhood),a=e.filter((t,r)=>e.indexOf(t)==r);t(null,a)}})}static fetchCuisines(t){DBHelper.fetchRestaurants((e,r)=>{if(e)t(e,null);else{const e=r.map((t,e)=>r[e].cuisine_type),a=e.filter((t,r)=>e.indexOf(t)==r);t(null,a)}})}static urlForRestaurant(t){return`./restaurant.html?id=${t.id}`}static imageUrlForRestaurant(t){return t.photograph?`/img/${t.photograph}.webp`:"/img/placeholder.webp"}static mapMarkerForRestaurant(t,e){return new google.maps.Marker({position:t.latlng,title:t.name,url:DBHelper.urlForRestaurant(t),map:e,animation:google.maps.Animation.DROP})}}